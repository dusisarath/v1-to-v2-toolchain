{
    "$schema": "http://json-schema.org/draft-04/schema#",
    "title": "Github Enterprise link",
    "description": "Github Enterprise link schema",
    "longDescription": "Source code from your existing repository will be migrated to a new repository on GitHub Enterprise. You can engage in social coding through wikis, issue tracking, and pull requests.",
    "type": "object",
    "properties": {
      "repo_name": {
          "title":"New repository name",
	  "description": "New repository name",
          "type": "string"
      },	    
      "existing_repo_url": {
          "title": "Existing Git Repository",
	  "description": "This is the repository from where the source code will be imported.",
          "type": "string",
	  "readonly": true    
      },
      "type": {
        "type": "string",
	"description": "Repository Type",      
	"enum": ["new"],
	"readonly": true      
      },
      "private_repo": {
         "title": "Private Repository",
         "description": "Select this check box to create a private repository.",
         "type": "boolean",
         "default": false
      },		    
      "has_issues": {
		"title": "Enable GitHub Enterprise Issues",
		"description": "Enable GitHub Enterprise Issues page for lightweight issue tracking.",
		"type": "boolean",
		"default": true
      },
      "migrateTAndP": {
      	            "title": "Do you want to migrate Track & Plan work items to GitHub Enterprise Issues?",
	            "description": "Track & Plan work items will be created as GitHub Enterprise issues in the existing repository",
	            "type": "boolean",
	            "enum": ["Yes", "No"]
      },
      "query": {
             "type": "string",
	     "title": "Track & Plan query",
	     "default": ""
      },
      "labels": {
        "type": "object",
        "title": "GitHub Enterprise issues use labels to track attributes. Select which work item attributes to map to labels in your new GitHub Enterprise issues",
        "properties": {
          "type": {"title": "type", "type": "boolean"},
          "severity": {"title": "severity", "type": "boolean"},
          "state": {"title": "state", "type": "boolean"},
          "priority": {"title": "priority", "type": "boolean"},
          "resolution": {"title": "resolution", "type": "boolean"},
          "filedAgainst": {"title": "filedAgainst", "type": "boolean"},
          "tags": {"title": "tags", "type": "boolean"}
        }
      },
      "enable_traceability": {
	      "type": "boolean",
	      "title": "Track deployment of code changes",
	      "description": "Select this check box to track the deployment of code changes by creating tags, labels and comments on commits, pull requests and referenced issues.",
	      "default": false
      }
    },
    "required": ["repo_name","type"],	
    "form": [
      {
        "type": "validator",
        "url": "/devops/setup/bm-helper/github_helper.html"
      }, 
      {
	 "type": "selectfieldset",
	 "key": "type",
	 "titleMap": {
		"new": "New"
	 },
	 "items": [{
		"type": "section",
		"items": ["repo_name", "existing_repo_url"]
	 }]     
      },
      {
      	"type": "group",
	"title": "Track & Plan Migration",
	"description": "Details for setting up the migration of your Track & Plan Work Items",
	"items" : [
		{
		  "type": "label",
		  "key": "desc",
		  "title": "Your new toolchain uses GitHub Enterprise Issues for issue tracking. \n\nTo keep your Track & Plan data, you must transfer it to GitHub Enterprise Issues now. [Learn more](https://console.ng.bluemix.net/docs/services/ContinuousDelivery/upgrade_projects.html)"	
		},
		 {
			"type": "selectfieldset",
			"key": "migrateTAndP",
			"readonly": true,
			"title-map": {
				 "Yes" : "Yes",
				 "No" : "No"
			},
			"items": [{
			       "type" : "section",
			       "description" : "",
			       "items" : [{
             				"type": "label",
				        "key" : "desc",
             				"title": "By default, all of your work items are migrated. If you want to migrate only specific items, specify a [Track & Plan query]({{rtcSharedQueriesLink}}).",
				        "description": "Work Items will be selected based on this Query (from Shared Queries). If Query is not specified, all work items are selected."
      					},{
					"type": "string",
					"key": "query",
					"readonly": false
					},
					"labels"]
			       }, {
			       "type" : "label",
			       "description" : "Track & Plan data will not be migrated."
			       }]
	      }
	
	]
     },{
	"type": "boolean",       
	"key": "enable_traceability"       
       } 
    ],
    "actions": {
      "create": ["has_issues","repo_name","type"]
    }	
}
